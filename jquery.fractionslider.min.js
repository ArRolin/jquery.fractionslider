/*
 * jQuery Fraction Slider v0.6
 * http://fractionslider.jacksbox.de
 *
 * Author: Mario JÃ¤ckle
 * eMail: support@jacksbopx.de
 *
 * Copyright 2013, jacksbox.design
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(e){var t=function(t,n){function l(){s.addClass("fraction-slider");if(n["controls"]){s.append('<a href="#" class="prev" ></a><a href="#" class="next" ></a>');s.find(".next").bind("click",function(){s.find("*").stop();p(r.currentSlide);r.currentSlide++;r.currentStep=0;if(r.currentSlide>r.maxSlide){r.currentSlide=0}h()});s.find(".prev").bind("click",function(){s.find("*").stop();p(r.currentSlide);r.currentSlide--;r.currentStep=0;if(r.currentSlide<0){r.currentSlide=r.maxSlide}h()})}if(n["fullWidth"]){s.css({overflow:"visible"})}else{s.css({overflow:"hidden"})}c()}function c(){if(r.init){var e=0;r.init=false}else{var e=n["timeout"];r.init=false}setTimeout(function(){if(r.maxSlide==0&&r.running==true){}else{p(r.currentSlide-1);h();r.running=true}},e)}function h(){if(n["backgroundAnimation"]){w()}var e=s.children(".slide:eq("+r.currentSlide+")");if(e.length==0){r.currentSlide=0;e=s.children(".slide:eq("+r.currentSlide+")")}d();e.show();e.children().hide();r.currentObj=0;r.maxObjs=0;r.finishedObjs=0;v()}function p(t){if(t<0){return}var r=s.children(".slide:eq("+t+")");var i=s.children(".slide:eq("+t+")").children();i.each(function(){var t=e(this);var r=t.position();var i=t.attr("data-out");var s=t.attr("data-ease-out");if(i==null){i=n["transitionOut"]}if(s==null){s=n["easeOut"]}b(t,r,i,s)}).promise().done(function(){r.hide()})}function d(){var t=s.children(".slide:eq("+r.currentSlide+")").children();var n=0;t.each(function(){var t=parseFloat(e(this).attr("data-step"));n=t>n?t:n});r.maxStep=n}function v(){if(r.currentStep==0){var e=s.children(".slide:eq("+r.currentSlide+")").children('*:not([data-step]), *[data-step="'+r.currentStep+'"]')}else{var e=s.children(".slide:eq("+r.currentSlide+")").children('*[data-step="'+r.currentStep+'"]')}r.maxObjs=e.length;i=e;if(r.maxObjs>0){r.currentObj=0;r.finishedObjs=0;m()}else{s.trigger("fraction:stepFinished")}}function m(){var t=e(i[r.currentObj]);var s=t.attr("data-position").split(",");var o=t.attr("data-in");var u=t.attr("data-delay");var a=t.attr("data-speed");var f=t.attr("data-ease-in");var l=t.attr("data-special");if(s==null){s=n["position"].split(",")}if(o==null){o=n["transitionIn"]}if(u==null){u=n["delay"]}if(f==null){f=n["easeIn"]}y(t,s,o,u,a,f,l);r.currentObj++;if(r.currentObj<r.maxObjs){m()}else{r.currentObj=0}}function g(){r.finishedObjs++;if(r.finishedObjs==r.maxObjs){s.trigger("fraction:stepFinished")}}function y(t,r,i,s,u,l,c){var h=null;var p=null;var d=null;var v=null;switch(i){case"left":h=r[0];p=o;break;case"bottomLeft":h=f;p=o;break;case"topLeft":h=t.outerHeight()*-1;p=o;break;case"top":h=t.outerHeight()*-1;p=r[1];break;case"bottom":h=f;p=r[1];break;case"right":h=r[0];p=0-a-t.outerWidth();break;case"bottomRight":h=f;p=0-a-t.outerWidth();break;case"topRight":h=t.outerHeight()*-1;p=0-a-t.outerWidth();break}d=r[0];v=r[1];if(u==null){u=n["speedIn"]}else{u=parseInt(u)}setTimeout(function(){if(c=="cycle"){var r=t.prev();if(r.length>0){var i=e(r).attr("data-position").split(",");i={top:i[0],left:i[1]};var s=e(r).attr("data-out");if(s==null){s=n["transitionOut"]}b(r,i,s,u)}}t.css({top:h+"px",left:p+"px"}).show().animate({top:d+"px",left:v+"px"},u,l,function(){g()}).addClass("altSlider_el_active")},s)}function b(e,t,r,i,s){var u=null;var l=null;switch(r){case"left":u=t["top"];l=0-a-100-e.outerWidth();break;case"bottomLeft":u=f;l=0-a-100-e.outerWidth();break;case"topLeft":u=e.outerHeight()*-1;l=0-a-100-e.outerWidth();break;case"top":u=e.outerHeight()*-1;l=t["left"];break;case"bottom":u=f;l=t["left"];break;case"right":u=t["top"];l=o;break;case"bottomRight":u=f;l=o;break;case"topRight":u=e.outerHeight()*-1;l=o;break}if(i==null){if(t["left"]>l){distX=Math.abs(t["left"]-l)}else if(t["left"]>l){distX=Math.abs(l-t["left"])}else{distX=0}if(t["top"]>u){distY=Math.abs(t["top"]-u)}else if(u>t["top"]){distY=Math.abs(u-t["top"])}else{distY=0}dist=Math.sqrt(distX*distX+distY*distY);var i=dist*(n["speedOut"]/1e3)}e.animate({top:u+"px",left:l+"px"},i,s,function(){e.hide()}).removeClass("altSlider_el_active")}function w(){if(n["backgroundElement"]==null||n["backgroundElement"]==""){var t=s}else{var t=e(n["backgroundElement"])}var r=t.css("background-position");r=r.split(" ");var i=n["backgroundX"];var o=n["backgroundY"];var u=Number(r[0].replace(/[px,%]/g,""))+i;var a=Number(r[0].replace(/[px,%]/g,""))+o;t.animate({backgroundPositionX:u+"px",backgroundPositionY:a+"px"},n["backgroundSpeed"],n["backgroundEase"])}var r={init:true,running:false,currentSlide:0,maxSlide:0,currentStep:0,maxStep:0,currentObj:0,maxObjs:0,finishedObjs:0};var i=null;var s=e(t);r.maxSlide=s.children(".slide").length-1;var o=s.width();var u=e("body").width();var a=(u-o)/2;if(n["fullWidth"]){o=u}var f=s.height();l();s.bind("fraction:stepFinished",function(){r.currentStep++;if(r.currentStep>r.maxStep){if(n["autoChange"]){r.currentSlide++;r.currentStep=0;c()}return}v()})};e.fn.fractionSlider=function(n){var n=e.extend({position:"0,0",transitionIn:"left",transitionOut:"left",fullWidth:false,delay:0,timeout:2e3,speedIn:2500,speedOut:1e3,easeIn:"easeOutExpo",easeOut:"easeOutCubic",controls:false,autoChange:true,backgroundAnimation:false,backgroundElement:null,backgroundX:500,backgroundY:500,backgroundSpeed:2500,backgroundEase:"easeOutCubic"},n);var r=new t(this,n)};var n={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,t){n[t]=function(t){return Math.pow(t,e+2)}});e.extend(n,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11){}return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}});e.each(n,function(t,n){e.easing["easeIn"+t]=n;e.easing["easeOut"+t]=function(e){return 1-n(1-e)};e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})})(jQuery)